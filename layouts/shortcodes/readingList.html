<div class="reading-list">
  {{/* Helper map to convert language codes to flag emojis */}}
  {{ $langFlags := dict "en" "ðŸ‡¬ðŸ‡§" "de" "ðŸ‡©ðŸ‡ª" "sv" "ðŸ‡¸ðŸ‡ª" "pl" "ðŸ‡µðŸ‡±" }}

  {{ range .Site.Data.reading }}
  {{ $book := . }}
  <div class="book-entry">
    {{ if .cover }}
    <div class="book-cover">
      {{ with .cover }}
        {{ $img := resources.Get . }}
        {{ with $img }}
          {{ $resized := .Fit "200x300" }}
          <img src="{{ $resized.RelPermalink }}" alt="Cover of {{ $book.title }}" loading="lazy">
        {{ end }}
      {{ end }}
    </div>
    {{ end }}

    <div class="book-details">
      <h3 class="book-title">
        {{ if .link }}
        <a href="{{ .link }}" target="_blank" rel="noopener" class="book-title-link">{{ .title }}</a>
        {{ else }} {{ .title }} {{ end }}
      </h3>
      <p class="book-meta">
        {{ .author }} â€¢ {{ .year }}
        {{ if .series }} â€¢ <em>{{ .series }}</em>{{ end }}
        {{ if .pages }} â€¢ {{ .pages }} pages{{ end }}
      </p>

      {{ if .originalLanguage }}
      <p>Original language: {{ index $langFlags .originalLanguage | default .originalLanguage }}</p>
      {{ end }}

      {{ if .languagesRead }}
      <p>Read in:
        {{ range $i, $lang := .languagesRead }}
          {{ if $i }}, {{ end }}{{ index $langFlags $lang | default $lang }}
        {{ end }}
      </p>
      {{ end }}

      {{ if .languagesListened }}
      <p>Listened in:
        {{ range $i, $lang := .languagesListened }}
          {{ if $i }}, {{ end }}{{ index $langFlags $lang | default $lang }}
        {{ end }}
      </p>
      {{ end }}

      {{ if .notes }}
      <p class="book-notes">{{ .notes }}</p>
      {{ end }}
    </div>
  </div>
  {{ end }}
</div>
